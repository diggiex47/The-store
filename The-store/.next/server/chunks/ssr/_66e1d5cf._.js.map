{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/src/lib/cart.ts"],"sourcesContent":["import { cookies } from \"next/headers\";\nimport prisma from \"@/lib/prisma\";\nimport { Prisma } from \"@prisma/client\";\n\nexport type cartWithProducts = Prisma.CartGetPayload<{\n  include: {\n    items: { include: { product: true } };\n  };\n}>;\n\nexport type shoppingCart = cartWithProducts & {\n  size: number;\n  subtotal: number;\n};\n\nexport async function getCart(): Promise<shoppingCart | null> {\n  // FIX: You must 'await' the cookies() function before calling .get()\n  const localCartId = (await cookies()).get(\"localCartId\")?.value;\n\n  const cart = localCartId\n    ? await prisma.cart.findUnique({\n        where: { id: localCartId },\n        include: {\n          items: { include: { product: true } },\n        },\n      })\n    : null;\n\n  if (!cart) {\n    return null;\n  }\n\n  return {\n    ...cart,\n    size: cart.items.reduce((acc, item) => acc + item.quantity, 0),\n    subtotal: cart.items.reduce(\n      (acc, item) => acc + item.quantity * item.product.price,\n      0,\n    ),\n  };\n}\n\nexport async function createCart(): Promise<shoppingCart> {\n  const newCart = await prisma.cart.create({\n    data: {},\n  });\n\n  // FIX 1: You must 'await' the cookies() function.\n  // FIX 2: The .set() method takes (key, value) as arguments, not an object.\n  const cookieStore = await cookies();\n  cookieStore.set(\"localCartId\", newCart.id);\n\n  // This part of your code is perfect.\n  return {\n    ...newCart,\n    items: [], // Explicitly add empty items to match the type\n    size: 0,\n    subtotal: 0,\n  };\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAcO,eAAe;IACpB,qEAAqE;IACrE,MAAM,cAAc,CAAC,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,GAAG,EAAE,GAAG,CAAC,gBAAgB;IAE1D,MAAM,OAAO,cACT,MAAM,oHAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAC3B,OAAO;YAAE,IAAI;QAAY;QACzB,SAAS;YACP,OAAO;gBAAE,SAAS;oBAAE,SAAS;gBAAK;YAAE;QACtC;IACF,KACA;IAEJ,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IAEA,OAAO;QACL,GAAG,IAAI;QACP,MAAM,KAAK,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,EAAE;QAC5D,UAAU,KAAK,KAAK,CAAC,MAAM,CACzB,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,GAAG,KAAK,OAAO,CAAC,KAAK,EACvD;IAEJ;AACF;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM,oHAAA,CAAA,UAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACvC,MAAM,CAAC;IACT;IAEA,kDAAkD;IAClD,2EAA2E;IAC3E,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAChC,YAAY,GAAG,CAAC,eAAe,QAAQ,EAAE;IAEzC,qCAAqC;IACrC,OAAO;QACL,GAAG,OAAO;QACV,OAAO,EAAE;QACT,MAAM;QACN,UAAU;IACZ;AACF","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/src/app/Product/%5Bid%5D/action.ts"],"sourcesContent":["\"use server\";\n\nimport { getCart, createCart } from \"@/lib/cart\";\nimport prisma from \"@/lib/prisma\";\nimport { revalidatePath } from \"next/cache\";\n\nexport async function IncProductCount(productId: string) {\n  const cart = (await getCart()) ?? (await createCart());\n\n  const articleInCart = cart.items.find((item) => item.productId === productId);\n\n  if (articleInCart) {\n    await prisma.cartItem.update({\n      where: { id: articleInCart.id },\n      data: { quantity: {increment: 1} },\n    });\n } else {\n    await prisma.cartItem.create({\n        data: {\n            cartId: cart.id,\n            productId,\n            quantity: 1,\n        },\n });\n}\n\nrevalidatePath(\"/Product/[id]\");\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;;;;;AAEO,eAAe,gBAAgB,SAAiB;IACrD,MAAM,OAAO,AAAC,MAAM,CAAA,GAAA,kHAAA,CAAA,UAAO,AAAD,OAAS,MAAM,CAAA,GAAA,kHAAA,CAAA,aAAU,AAAD;IAElD,MAAM,gBAAgB,KAAK,KAAK,CAAC,IAAI,CAAC,CAAC,OAAS,KAAK,SAAS,KAAK;IAEnE,IAAI,eAAe;QACjB,MAAM,oHAAA,CAAA,UAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC3B,OAAO;gBAAE,IAAI,cAAc,EAAE;YAAC;YAC9B,MAAM;gBAAE,UAAU;oBAAC,WAAW;gBAAC;YAAE;QACnC;IACH,OAAO;QACJ,MAAM,oHAAA,CAAA,UAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;YACzB,MAAM;gBACF,QAAQ,KAAK,EAAE;gBACf;gBACA,UAAU;YACd;QACP;IACD;IAEA,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;AACf;;;IArBsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/.next-internal/server/app/Product/%5Bid%5D/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {$$RSC_SERVER_ACTION_0 as '406978e7eac1c73712da718d70bd654ff47c60fb03'} from 'ACTIONS_MODULE0'\nexport {IncProductCount as '40c0c940b552a32ad9ad82295410fa6356fd02f181'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AACA","debugId":null}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/src/lib/format.ts"],"sourcesContent":["export  function formatPrice(price: number) {\n    return (price).toLocaleString('en-US', {\n        style: 'currency',\n        currency: 'INR',\n    });\n}"],"names":[],"mappings":";;;AAAQ,SAAS,YAAY,KAAa;IACtC,OAAO,AAAC,MAAO,cAAc,CAAC,SAAS;QACnC,OAAO;QACP,UAAU;IACd;AACJ","debugId":null}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/src/components/priceTag/page.tsx"],"sourcesContent":["import { formatPrice } from \"@/lib/format\"\n\ninterface PriceTagProps {\n    price: number,\n    className?: string,\n}\n\nexport default function PriceTag({price,  }: PriceTagProps){\n\n    return <span className={'badge ${className}'}> {formatPrice(price)}</span>\n}   "],"names":[],"mappings":";;;;AAAA;;;AAOe,SAAS,SAAS,EAAC,KAAK,EAAmB;IAEtD,qBAAO,8OAAC;QAAK,WAAW;;YAAsB;YAAE,CAAA,GAAA,oHAAA,CAAA,cAAW,AAAD,EAAE;;;;;;;AAChE","debugId":null}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/src/app/Product/%5Bid%5D/AddToCartButton.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/Product/[id]/AddToCartButton.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/Product/[id]/AddToCartButton.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA4S,GACzU,0EACA","debugId":null}},
    {"offset": {"line": 236, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/src/app/Product/%5Bid%5D/AddToCartButton.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/Product/[id]/AddToCartButton.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/Product/[id]/AddToCartButton.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAwR,GACrT,sDACA","debugId":null}},
    {"offset": {"line": 250, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/The-store/src/app/Product/%5Bid%5D/page.tsx"],"sourcesContent":["import prisma from \"@/lib/prisma\";\nimport { notFound } from \"next/navigation\";\nimport Image from \"next/image\";\nimport PriceTag from \"@/components/priceTag/page\";\nimport { cache } from \"react\";\nimport { Metadata } from \"next\";\nimport AddToCartButton from \"./AddToCartButton\";\nimport { IncProductCount } from \"./action\";\n\ninterface ProductPageProps {\n    params: {id : string};\n}\n\nconst getProduct = cache(async (id: string) => {\n    const product = await prisma.product.findUnique({where: {id}})\n    if(!product) notFound();\n    return product;\n})\n\nexport async function generateMetadata({params: {id}}: ProductPageProps): Promise<Metadata> {\n    const product = await getProduct(id);\n\n    return {\n        title: product.name + \" | The Store\",\n        description: product.description,\n        openGraph: {\n            images: [{url: product.imageUrl}],\n    },\n};\n}\n\nexport default async function ProductPage(\n    {params: {id}} : ProductPageProps\n){\n    const product = await prisma.product.findUnique({where: {id}})\n    if(!product) notFound();\n\n\n    return (\n        <div className=\"flex flex-col items-center justify-center gap-4 lg:flex-row\">\n            <Image \n            src={product.imageUrl}\n            alt={product.name}\n            width={300}\n            height={300}\n            className=\"rounded-lg shadow-lg\"\n            priority\n            />\n\n            <div>\n                <h1 className=\"text-2xl font-bold mt-4\">{product.name}</h1>\n                <PriceTag  price={product.price} className=\"mt-2\"/>\n                <p className=\"my-6\">{product.description}</p>\n                <AddToCartButton productId={product.id}\n                IncProductCount = {IncProductCount}\n                />\n            </div>\n        </div>\n    )\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;;;;;;;;;AAMA,MAAM,aAAa,CAAA,GAAA,qMAAA,CAAA,QAAK,AAAD,EAAE,OAAO;IAC5B,MAAM,UAAU,MAAM,oHAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAAC,OAAO;YAAC;QAAE;IAAC;IAC5D,IAAG,CAAC,SAAS,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD;IACpB,OAAO;AACX;AAEO,eAAe,iBAAiB,EAAC,QAAQ,EAAC,EAAE,EAAC,EAAmB;IACnE,MAAM,UAAU,MAAM,WAAW;IAEjC,OAAO;QACH,OAAO,QAAQ,IAAI,GAAG;QACtB,aAAa,QAAQ,WAAW;QAChC,WAAW;YACP,QAAQ;gBAAC;oBAAC,KAAK,QAAQ,QAAQ;gBAAA;aAAE;QACzC;IACJ;AACA;AAEe,eAAe,YAC1B,EAAC,QAAQ,EAAC,EAAE,EAAC,EAAoB;IAEjC,MAAM,UAAU,MAAM,oHAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAAC,OAAO;YAAC;QAAE;IAAC;IAC5D,IAAG,CAAC,SAAS,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD;IAGpB,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC,6HAAA,CAAA,UAAK;gBACN,KAAK,QAAQ,QAAQ;gBACrB,KAAK,QAAQ,IAAI;gBACjB,OAAO;gBACP,QAAQ;gBACR,WAAU;gBACV,QAAQ;;;;;;0BAGR,8OAAC;;kCACG,8OAAC;wBAAG,WAAU;kCAA2B,QAAQ,IAAI;;;;;;kCACrD,8OAAC,sIAAA,CAAA,UAAQ;wBAAE,OAAO,QAAQ,KAAK;wBAAE,WAAU;;;;;;kCAC3C,8OAAC;wBAAE,WAAU;kCAAQ,QAAQ,WAAW;;;;;;kCACxC,8OAAC,mJAAA,CAAA,UAAe;wBAAC,WAAW,QAAQ,EAAE;wBACtC,iBAAmB,yIAAA,CAAA,kBAAe;;;;;;;;;;;;;;;;;;AAKlD","debugId":null}}]
}
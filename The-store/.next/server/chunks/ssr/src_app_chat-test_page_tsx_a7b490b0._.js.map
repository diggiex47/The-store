{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/milo/Project/Design/The-store/src/app/chat-test/page.tsx"],"sourcesContent":["// components/Chat.tsx\n\"use client\";\n\nimport { useEffect, useState, useRef } from \"react\";\nimport { useAuth } from \"../context/AuthContext\";\n\n// Define the shape of a message for TypeScript\ninterface Message {\n  content: string;\n  userID: string;\n  username: string;\n}\n\nconst WEBSOCKET_URL = \"ws://localhost:8000/api/ws\";\n\nexport default function Chat() {\n  const { user } = useAuth();\n  const [socket, setSocket] = useState<WebSocket | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState(\"\");\n  const [connectionStatus, setConnectionStatus] = useState(\"Connecting...\");\n\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  useEffect(() => {\n    const ws = new WebSocket(WEBSOCKET_URL);\n    ws.onopen = () => setConnectionStatus(\"Connected\");\n    ws.onmessage = (event) => {\n      const receivedMessage: Message = JSON.parse(event.data);\n      setMessages((prevMessages) => [...prevMessages, receivedMessage]);\n    };\n    ws.onerror = () => setConnectionStatus(\"Error: Connection failed.\");\n    ws.onclose = () => {\n      if (connectionStatus !== \"Connected\") {\n        setConnectionStatus(\"Error: Could not connect.\");\n      }\n    };\n    setSocket(ws);\n    return () => ws.close();\n  }, []);\n\n  const sendMessage = () => {\n    if (socket && input && socket.readyState === WebSocket.OPEN) {\n      socket.send(JSON.stringify({ content: input }));\n      setInput(\"\");\n    }\n  };\n\n  // The UI part using DaisyUI classes\n  return (\n    <div className=\"card bg-base-100 w-96 shadow-xl align-center\">\n      <div className=\"card-body\">\n        <h2 className=\"card-title\">Chat Room</h2>\n\n        {/* Message Display Box */}\n        <div className=\"bg-base-200 h-80 overflow-y-auto rounded-lg p-4\">\n          {messages.map((msg, index) => (\n            <div\n              key={index}\n              className={`chat ${msg.userID === user?.id ? \"chat-end\" : \"chat-start\"}`}\n            >\n              <div className=\"chat-header\">{msg.username}</div>\n              <div\n                className={`chat-bubble ${msg.userID === user?.id ? \"chat-bubble-primary\" : \"\"}`}\n              >\n                {msg.content}\n              </div>\n            </div>\n          ))}\n          <div ref={messagesEndRef} />\n        </div>\n\n        {/* Text Box to Send Message */}\n        <div className=\"card-actions mt-4 items-center justify-between\">\n          <input\n            type=\"text\"\n            placeholder=\"Type here\"\n            className=\"input input-bordered w-full max-w-xs\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\") {\n                sendMessage();\n              }\n            }}\n          />\n          <button onClick={sendMessage} className=\"btn btn-primary\">\n            Send\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,sBAAsB;;;;;AAGtB;AACA;AAHA;;;;AAYA,MAAM,gBAAgB;AAEP,SAAS;IACtB,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,oIAAA,CAAA,UAAO,AAAD;IACvB,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAoB;IACvD,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEzD,MAAM,iBAAiB,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAE9C,MAAM,iBAAiB;QACrB,eAAe,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IAC9D;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR;IACF,GAAG;QAAC;KAAS;IAEb,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,KAAK,IAAI,UAAU;QACzB,GAAG,MAAM,GAAG,IAAM,oBAAoB;QACtC,GAAG,SAAS,GAAG,CAAC;YACd,MAAM,kBAA2B,KAAK,KAAK,CAAC,MAAM,IAAI;YACtD,YAAY,CAAC,eAAiB;uBAAI;oBAAc;iBAAgB;QAClE;QACA,GAAG,OAAO,GAAG,IAAM,oBAAoB;QACvC,GAAG,OAAO,GAAG;YACX,IAAI,qBAAqB,aAAa;gBACpC,oBAAoB;YACtB;QACF;QACA,UAAU;QACV,OAAO,IAAM,GAAG,KAAK;IACvB,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,IAAI,UAAU,SAAS,OAAO,UAAU,KAAK,UAAU,IAAI,EAAE;YAC3D,OAAO,IAAI,CAAC,KAAK,SAAS,CAAC;gBAAE,SAAS;YAAM;YAC5C,SAAS;QACX;IACF;IAEA,oCAAoC;IACpC,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAAa;;;;;;8BAG3B,8OAAC;oBAAI,WAAU;;wBACZ,SAAS,GAAG,CAAC,CAAC,KAAK,sBAClB,8OAAC;gCAEC,WAAW,CAAC,KAAK,EAAE,IAAI,MAAM,KAAK,MAAM,KAAK,aAAa,cAAc;;kDAExE,8OAAC;wCAAI,WAAU;kDAAe,IAAI,QAAQ;;;;;;kDAC1C,8OAAC;wCACC,WAAW,CAAC,YAAY,EAAE,IAAI,MAAM,KAAK,MAAM,KAAK,wBAAwB,IAAI;kDAE/E,IAAI,OAAO;;;;;;;+BAPT;;;;;sCAWT,8OAAC;4BAAI,KAAK;;;;;;;;;;;;8BAIZ,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,MAAK;4BACL,aAAY;4BACZ,WAAU;4BACV,OAAO;4BACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;4BACxC,WAAW,CAAC;gCACV,IAAI,EAAE,GAAG,KAAK,SAAS;oCACrB;gCACF;4BACF;;;;;;sCAEF,8OAAC;4BAAO,SAAS;4BAAa,WAAU;sCAAkB;;;;;;;;;;;;;;;;;;;;;;;AAOpE","debugId":null}}]
}